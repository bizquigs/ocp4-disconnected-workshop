= Post-Install Configuration

**Congratulations** you've successfully created an OpenShift cluster in a disconnected environment!

ðŸª© ðŸ’ƒ It's DISCO time! ðŸ•º ðŸª©

Or, perhaps, your cluster will finish installing in the next ~30 minutes. ðŸ˜¸

Don't worry!
Your workshop environment also includes a previously-built disconnected **Salsa cluster**.
You can complete this lab using either cluster.

image::disco-4.svg[disco diagram,800]

//TODO - more highlighting for the [.salsa] objects???

== Are we done yet?

Installing OpenShift in a disconnected environment concludes the __"day 1"__ tasks.
However, a disconnected cluster is more useful when you make a few simple configuration changes.
These are commonly referred to as __"day 2"__ tasks.

Here are a few suggested __"day 2"__ tasks that will improve your experience.

{counter:overview}. Disable the default app / Operator `CatalogSources`

{counter:overview}. Create your own app / Operator `CatalogSource`

{counter:overview}. Install additional `ImageContentSourcePolicies`

{counter:overview}. Update OpenShift from a disconnected _Update Server_

[INFO]
You may not have enough time during the Summit 2024 lab session to complete the __Update Server__ task.

== Accessing your cluster

Because of time constraints, we recommend that you decide now to either use your **disco.lab** cluster, or the prebuilt **salsa.lab** cluster.

The instructions are the same - only the names change.

We will assume for now that you will be using the pre-built **salsa.lab** cluster.

=== Accessing the cluster's web console

Before you launch a web browser, you need to find the randomized password that was assigned to your cluster's `kubeadmin` user.
The password is printed when `openshift-install` finishes.
But, if you don't want to wait, you can lookup the password with these commands:

[.highside,source,bash,role=execute,subs="attributes"]
----
echo "URL: https://console-openshift-console.apps.disco.lab"
echo "Username: kubeadmin"
echo "Password: $(more /mnt/high-side-data/install/auth/kubeadmin-password)"
----
[.output]
----
URL: https://console-openshift-console.apps.disco.lab
Username: kubeadmin
Password: fKLcS-EuJDs-SfrVD-nbbvA
----

[TIP]
--
The pre-built **salsa.lab** cluster credentials are `admin` / `admin`.

There is also a non-admin user available as `user` / `user`.
--

Now you can click the *Desktop* button on the right-hand side and use Firefox to login to the OpenShift __Web Console__.
The __Web Console__ is the very last part of OpenShift to come online.
If you are trying to connect to your [.highside]#disco.lab# cluster, and see an "**Application is not available**" message, it means the installation hasn't completed yet.

Your workshop environment includes a Firefox bookmark to quickly connect with the __Web Console__.

image::vnc-disco-openshift-bookmark.png[console]

The web-based VNC client is a bit klunky when it comes to **copy** and **paste**.
You can copy and paste into the VNC desktop using __noVNC__'s tool ribbon (hidden by default.) 

image::vnc-copy-paste.png[console]


//TODO - cleanup needed here
=== Accessing the cluster from the command-line

You should be able to access the API server from the *highside* system by leveraging the `kubeconfig` file the installer creates for you:

[.highside,source,bash,role=execute,subs="attributes"]
----
mkdir -vp $HOME/.kube
cp -v /mnt/high-side/install/auth/kubeconfig $HOME/.kube/config
oc status
----
[.output]
----
In project default on server https://api.disco.lab:6443

svc/openshift - kubernetes.default.svc.cluster.local
svc/kubernetes - 172.30.0.1:443 -> 6443

View details with 'oc describe <resource>/<name>' or list resources with 'oc get all'.
----

Now that you're logged in via the command-line or the _Web Console_ we can proceed with the __"day 2"__ tasks.

== Post-Install Cluster Configurations

Now that we have a cluster up and running (or we are using the pre-made salsa.lab cluster) we can perform some
post-install steps that are specific to a disconnected environment.

[cols="a,a",options="header"]
|===
| Using the pre-built `salsa.lab` cluster
| Using your own `disco.lab` cluster

**Note to self** - do we want to use `ssh`? I would suggest doing `oc login` from the [.lowside]#jump system#.

|
[source,bash,role=execute]
----
ssh salsa-registry
oc login https://api.salsa.lab:6443
----
|
[source,bash,role=execute]
----
ssh highside
oc login https://api.disco.lab:6443
----

|
* *Username:* kubeadmin
* *Password:* (in `cluster/auth/kubeadmin-password`)
|
* *Username:* admin
* *Password:* admin
|===

=== Add our custom catalog source
// https://docs.openshift.com/container-platform/4.14/installing/installing_aws/installing-restricted-networks-aws-installer-provisioned.html#olm-restricted-networks-operatorhub_installing-restricted-networks-aws-installer-provisioned

TODO

=== Deploy a operator

TODO

// == Add images with `podman`
// https://docs.openshift.com/container-platform/4.14/post_installation_configuration/cluster-tasks.html#post-install-must-gather-disconnected

// == Remove default samples operator
// https://docs.openshift.com/container-platform/4.14/openshift_images/configuring-samples-operator.html#configuring-samples-operator

=== Update cluster

TODO
